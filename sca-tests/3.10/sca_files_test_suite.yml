# Security Configuration assessment
# Testing suite for directory checks (v3.9.0)
# Copyright (C) 2015-2019, Wazuh Inc.
#
# This program is a free software; you can redistribute it
# and/or modify it under the terms of the GNU General Public
# License (version 2) as published by the FSF - Free Software
# Foundation
policy:
  id: sca_files_test_suite
  file: sca_files_test_suite.yml
  name: Test suite for file rules
  description: This document includes file rules for testing purposes with the syntax rule of Wazuh v3.10.0
###############Â Expected results
# Passed = 8
# Failed = 7
# Invalid = 1
# Total checks = 16
# Directory checks
checks:
###############################
# Single file existence checks #
###############################
 - id: 100100
   title: PASS -- existing file exists
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf
 - id: 100101
   title: FAIL -- a non-existing file file should exist
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf_FAIL
 - id: 100102
   title: PASS -- a non-existing file does not exist
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf_FAIL
 - id: 100103
   title: FAIL -- existing file file should not exist
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf
###############################
# File lists existence checks #
###############################
# When listing more than one directory, the existence of one of them stops the searching (OR operation)
 - id: 100200
   title: PASS -- Last file exists
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf_FAIL0,/var/ossec/etc/ossec.conf_FAIL1,/var/ossec/etc/ossec.conf

 - id: 100201
   title: FAIL -- Files do not exist
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf_FAIL0,/var/ossec/etc/ossec.conf_FAIL1,/var/ossec/etc/ossec.conf_FAIL2

 - id: 100202
   title: FAIL -- Negated last file exists
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf_FAIL0,/var/ossec/etc/ossec.conf_FAIL1,/var/ossec/etc/ossec.conf

 - id: 100203
   title: PASS -- Negated non-existing list
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf_FAIL0,/var/ossec/etc/ossec.conf_FAIL1,/var/ossec/etc/ossec.conf_FAIL2

###########################
# Content wise file rules #
###########################
 - id: 100300
   title: PASS -- Full rule regex match
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf -> r:^<ossec_config>
 - id: 100301
   title: FAIL -- negated full rule regex match
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf -> r:^<ossec_config>
 - id: 100302
   title: FAIL -- Full rule regex does not match
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf -> r:^FAIL;
 - id: 100303
   title: PASS -- negated full rule regex does not match
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf -> r:^FAIL;
 - id: 100304
   title: PASS -- negated regex matches (because !r:^FAIL matches everything but ^FAIL)
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf -> !r:^FAIL;
 - id: 100305
   title: INVALID -- File does not exist
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf_FAIL -> r:^FAKE;
 - id: 100306
   title: FAIL -- Contradictory match
   condition: any
   rules:
     - f:/var/ossec/etc/ossec.conf -> r:^FAIL && !r:^FAIL

 - id: 100307
   title: PASS -- Negated contradictory match -> Tautology
   condition: any
   rules:
     - not f:/var/ossec/etc/ossec.conf -> r:^FAIL && !r:^FAIL
